rule_id: STE0201
name: Hard LP Pull
description: Detect major rapid liquidity removal via a single burn or a short burst of burns while filtering for non-malicious liquidity management activity.
version: 4.0.0
source: STE0200
detection_type: total_lp_pull
parameters:
  window_seconds: 5
  min_burn_frac: 0.85
  min_step_burn_frac: 0.35
  min_total_drop_frac: 0.85
  min_sequence_windows: 2
  max_sequence_windows: 5
  max_sequence_span_seconds: 120
  min_context_burn_events: 1
  min_burn_to_mint_ratio: 3.0
  min_time_since_last_mint_sec: 300
  min_peak_drop_frac: 0.6
  min_start_peak_ratio: 0.6
  start_peak_ratio_override_peak_drop: 0.95
  pre_rug_sell_lookback_windows: 120
  max_pre_rug_sell_base_volume_ratio_for_detection: 0.2
  min_net_base_withdraw_ratio_for_detection: 0.0
  min_net_base_withdraw_abs_for_detection: 0.0
  min_net_quote_profit_ratio_for_detection: 0.0
  min_net_quote_profit_abs_for_detection: 0.0
scoring:
  base_score: 72.0
  bonus_weight: 22.0
  detection_threshold: 80.0
  decay_per_window: 0.0
evidence:
  lookback_windows: 12
  qualitative_reason: "Liquidity supply collapsed without replenishment or recent mint activity."
